<t-popup visible="{{visible}}" placement="bottom" bind:visible-change="onVisibleChange">
  <view class="form-card popup-card">
    <view class="form-header">
      <text class="form-header-left">åˆ†ç±»ï¼š{{categoryName}}</text>
      <text class="form-header-right">å•ä½ï¼šå…ƒ</text>
    </view>

    <view class="input-area">
      <view class="amount-row">
        <text class="amount-label">{{type === 'expense' ? 'æ”¯å‡º' : 'æ”¶å…¥'}}</text>
        <text class="amount-value">{{amount || '0.00'}}</text>
      </view>
    </view>

    <view class="keyboard">
      <view class="keyboard-main">
        <view wx:for="{{['7','8','9','4','5','6','1','2','3','0','.']}}" wx:key="*this" class="key" catchtap="onKeyTap" data-key="{{item}}">{{item}}</view>
        <view class="key back" catchtap="onBackspace">âŒ«</view>
      </view>
      <view class="keyboard-side">
        <picker mode="date" value="{{pickerDateValue}}" bindchange="onDatePickerChange" class="side-key date">
          <view>
            <text class="side-key-icon">ğŸ“…</text>
            <text class="side-key-text">æ—¥æœŸ</text>
            <text class="side-key-sub">{{selectedDate}}</text>
          </view>
        </picker>
        <view class="side-key" catchtap="onKeyTap" data-key="+">
          <text class="side-key-icon">ï¼‹</text>
          <text class="side-key-text">åŠ </text>
        </view>
        <view class="side-key" catchtap="onKeyTap" data-key="-">
          <text class="side-key-icon">ï¼</text>
          <text class="side-key-text">å‡</text>
        </view>
        <view class="side-key done {{isCalculating ? 'calculating' : ''}}" catchtap="handleDone">
          <text class="side-key-text done-text">{{isCalculating ? '=' : 'å®Œæˆ'}}</text>
        </view>
      </view>
    </view>
  </view>
</t-popup>