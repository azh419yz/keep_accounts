<view class="page">
  <!-- é¡¶éƒ¨ï¼šæ”¯å‡º / æ”¶å…¥ Tab + å–æ¶ˆ -->
  <t-navbar title="">
    <view slot="left" class="header-left">
      <view class="type-toggle">
        <view class="type-toggle-inner">
          <view 
            class="type-item {{recordType === 'expense' ? 'active' : ''}}"
            bindtap="onRecordTypeChange"
            data-type="expense"
          >æ”¯å‡º</view>
          <view 
            class="type-item {{recordType === 'income' ? 'active' : ''}}"
            bindtap="onRecordTypeChange"
            data-type="income"
          >æ”¶å…¥</view>
        </view>
      </view>
    </view>
    <view slot="right" class="header-right">
      <text class="cancel-text" bindtap="onCancel">å–æ¶ˆ</text>
    </view>
  </t-navbar>

  <scroll-view class="content" scroll-y>
    <!-- ç±»åˆ«ç½‘æ ¼ -->
    <view class="section">
      <text class="section-title">é€‰æ‹©ç±»åˆ«</text>
      <t-grid column="{{4}}" border="{{false}}">
        <t-grid-item wx:for="{{categories}}" wx:key="id">
          <view 
            class="category-item {{selectedCategory === item.id ? 'active' : ''}}"
            bindtap="onCategorySelect"
            data-id="{{item.id}}"
            data-name="{{item.name}}"
          >
            <view class="category-icon {{item.class}}">{{item.icon}}</view>
            <text class="category-text">{{item.name}}</text>
          </view>
        </t-grid-item>
      </t-grid>
    </view>

    <!-- è®°å½•è¡¨å• -->
    <view class="form-card" wx:if="{{selectedCategory}}">
      <view class="form-header">
        <text class="form-header-left">å½“å‰ç±»åˆ«ï¼š{{selectedCategoryName}}</text>
        <text class="form-header-right">å•ä½ï¼šå…ƒ</text>
      </view>
      <view class="amount-row">
        <text class="amount-label">{{recordType === 'expense' ? 'æ”¯å‡º' : 'æ”¶å…¥'}}é‡‘é¢ï¼ˆå¯è®¡ç®—ï¼‰</text>
        <text class="amount-value">{{amount || '0.00'}}</text>
      </view>

      <t-cell-group>
        <t-cell hover="{{false}}">
          <view class="remark-row">
            <text class="remark-icon">ğŸ“</text>
            <t-input
              value="{{remark}}"
              placeholder="å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰"
              borderless="{{true}}"
              bindchange="onRemarkChange"
            />
          </view>
        </t-cell>
      </t-cell-group>

      <view class="keyboard">
        <view class="keyboard-main">
          <view 
            wx:for="{{['7','8','9','4','5','6','1','2','3','0','.']}}" 
            wx:key="*this"
            class="key"
            bindtap="onKeyTap"
            data-key="{{item}}"
          >{{item}}</view>
          <view class="key back" bindtap="onBackspace">âŒ«</view>
        </view>
        <view class="keyboard-side">
          <picker
            mode="date"
            value="{{pickerDateValue}}"
            bindchange="onDatePickerChange"
            class="side-key date"
          >
            <view>
              <text class="side-key-icon">ğŸ“…</text>
              <text class="side-key-text">æ—¥æœŸ</text>
              <text class="side-key-sub">{{selectedDate}}</text>
            </view>
          </picker>
          <view class="side-key" bindtap="onAdd">
            <text class="side-key-icon">ï¼‹</text>
            <text class="side-key-text">åŠ </text>
          </view>
          <view class="side-key" bindtap="onSubtract">
            <text class="side-key-icon">ï¼</text>
            <text class="side-key-text">å‡</text>
          </view>
          <view class="side-key done" bindtap="onSubmit">
            <text class="side-key-text done-text">å®Œæˆ</text>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>


